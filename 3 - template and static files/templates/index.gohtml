<html>

<head>

    <style>
        body {
            margin: 0;
            padding: 0;
        }

        .grid-sizer {
            width: 25%
        }

        .item:nth-child(3n+2) {
            width: 50%
        }

        .item {
            width: 25%;
            height: 100px;
            overflow: hidden
        }

        .bg {
            min-width: 100%;
            min-height: 100%;
            display: block;
            background-repeat: no-repeat !important;
            background-size: cover !important;
            transition: all 0.2s ease-in-out;
        }

        .item:hover .bg {
            transform: scale3d(1.1, 1.1, 1.1);
        }
    </style>

    <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>

</head>

<body>


    <div class="container">

        <div class="grid">
            <div class="grid-sizer"></div>
            <div class="item">
                <div class="bg"></div>
            </div>
            <div class="item">
                <div class="bg"></div>
            </div>
            <div class="item">
                <div class="bg"></div>
            </div>
            <div class="item">
                <div class="bg"></div>
            </div>
            <div class="item">
                <div class="bg"></div>
            </div>
            <div class="item">
                <div class="bg"></div>
            </div>
            <div class="item">
                <div class="bg"></div>
            </div>
            <div class="item">
                <div class="bg"></div>
            </div>

        </div>
    </div>

    <script>
        //Array.from(document.body.querySelector('.item')).forEach(a => a.style.height = a.style.width);

        function setHeight() {
            var elements = document.body.querySelectorAll('.item');

            [].forEach.call(elements, function (el) {
                el.style.height = el.offsetWidth
                // el.innerHTML = "foo";
            });
        }

        function setBG() {
            var elements = document.body.querySelectorAll('.bg');

            [].forEach.call(elements, function (el) {
                if (el.offsetWidth <= 450) {
                    el.style.backgroundImage = "url(images/small.jpeg)"
                } else {
                    el.style.backgroundImage = "url(images/big.jpeg)"
                }
                // el.style.backgroundImage = "url(https://unsplash.it/" + (el.offsetWidth * 2) + "/?random"
                // el.innerHTML = "foo";
            });
        }

        function init() {
            setHeight();
            setBG();
        }

        init()

        window.addEventListener('resize', function (event) {
            setHeight()
        });

        var elem = document.querySelector('.grid');
        var msnry = new Masonry(elem, {
            // options
            itemSelector: '.item',
            columnWidth: '.grid-sizer',

        });
    </script>
</body>

</html>